<agent_config>

  <syscheck merge="replace">
    <disabled>no</disabled>

    <!-- Ignorowanie specyficznych ścieżek -->
    <ignore>c:\windows\system32\drivers\driverdata\intel\dptf</ignore>
    <ignore>c:\windows\system32\drivers\driverdata\intel\dptf\dv\dptf.dv</ignore>

    <!-- Katalogi krytyczne w realtime -->
    <directories realtime="yes" report_changes="yes">
      C:\Windows\System32\drivers
      C:\Windows\System32\config
      C:\Windows\System32
    </directories>

    <!-- Duże drzewka skanowane co 12h -->
    <directories realtime="no" report_changes="yes">
      C:\Program Files
      C:\Program Files (x86)
    </directories>

    <!-- Pobrane użytkowników -->
    <directories realtime="yes">C:\Users\*\Downloads</directories>

    <frequency>43200</frequency>

    <!-- Rejestr w realtime -->
    <registry realtime="yes" report_changes="yes">
      HKLM\SOFTWARE
      HKLM\SYSTEM
      HKLM\SECURITY
      HKCU\SOFTWARE
    </registry>

    <!-- Ignorowanie logów i tempów -->
    <ignore>.*\.log$</ignore>
    <ignore>C:\\Windows\\Temp\\.*</ignore>

    <!-- Wyższy limit plików -->
    <file_limit>
      <enabled>yes</enabled>
      <entries>200000</entries>
    </file_limit>

    <!-- Profile użytkownika w realtime -->
    <directories realtime="yes" report_changes="yes">
      C:\Users\*\Desktop
      C:\Users\*\Downloads
      C:\Users\*\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
    </directories>

    <!-- Generowanie alertu przy nowych plikach -->
    <alert_new_files>yes</alert_new_files>

    <!-- Nie ignoruj plików zmienianych częściej niż frequency -->
    <auto_ignore frequency="10" timeframe="3600">no</auto_ignore>

    <!-- Monitorowanie dodatkowych katalogów -->
    <directories check_all="yes">C:\Users\*\Downloads</directories>

    <!-- Wzorce do ignorowania -->
    <ignore type="sregex">.log$|.swp$</ignore>

    <!-- Pomiń wybrane systemowe katalogi -->
    <skip_nfs>yes</skip_nfs>
    <skip_dev>yes</skip_dev>
    <skip_proc>yes</skip_proc>
    <skip_sys>yes</skip_sys>

    <!-- Nice value dla Syscheck -->
    <process_priority>10</process_priority>

    <!-- Maksymalny throughput -->
    <max_eps>50</max_eps>

    <!-- Synchronizacja bazy -->
    <synchronization>
      <enabled>yes</enabled>
      <interval>5m</interval>
      <max_eps>10</max_eps>
    </synchronization>

  </syscheck>  

</agent_config>
